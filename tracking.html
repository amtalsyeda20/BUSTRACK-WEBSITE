<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BusTrack | Live Tracking</title>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">

<!-- Leaflet Map Library -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
  * {margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif;}
  html {scroll-behavior: smooth;}
  body {
    color: #fff;
    background: #000;
    overflow-x: hidden;
    position: relative;
    min-height: 100vh;
  }
  body::before {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: url("images/bus.gif") no-repeat center center/cover;
    z-index: -2;
    opacity: 0.4;
  }
  body::after {
    content: "";
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: linear-gradient(180deg, rgba(0,0,0,0.7), rgba(10,10,40,0.8));
    z-index: -1;
  }

  /* ---------- NAVBAR ---------- */
  nav {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(10, 10, 30, 0.9);
    padding: 15px 60px;
    position: fixed;
    top: 0;
    z-index: 10;
    backdrop-filter: blur(10px);
    border-bottom: 2px solid rgba(255,215,0,0.2);
  }
  .logo-container {
    display: flex;
    align-items: center;
    gap: 12px;
  }
  .logo-container img {
    height: 45px;
    width: 45px;
    border-radius: 50%;
    box-shadow: 0 0 10px rgba(255,215,0,0.5);
  }
  .logo-container h1 {
    font-size: 1.8rem;
    font-weight: 700;
    color: #ffd700;
    text-shadow: 0 0 8px rgba(255,215,0,0.5);
  }
  nav ul {
    list-style: none;
    display: flex;
    gap: 30px;
  }
  nav ul li {
    font-size: 1.1rem;
    cursor: pointer;
    transition: 0.3s;
  }
  nav ul li:hover {
    color: #ffd700;
    text-shadow: 0 0 10px #ffd700;
  }

  /* ---------- HEADER ---------- */
  .header {
    margin-top: 130px;
    text-align: center;
    padding: 40px 20px;
    animation: fadeIn 1.2s ease;
  }
  .header h2 {
    font-size: 3rem;
    color: #ffd700;
    text-shadow: 0 0 20px rgba(255,215,0,0.6);
  }
  .header p {
    color: #f0f0f0;
    margin-top: 15px;
    font-size: 1.2rem;
  }

  /* ---------- SELECTOR ---------- */
  .bus-selector {text-align: center; margin-top: 25px; animation: fadeInUp 1.2s ease;}
  select {
    padding: 12px 25px;
    border-radius: 25px;
    border: none;
    outline: none;
    font-size: 1rem;
    color: #0b1e45;
    font-weight: 600;
    background-color: #ffd700;
    box-shadow: 0 0 25px rgba(255,215,0,0.6);
    transition: 0.3s;
  }
  select:hover {transform: scale(1.05); box-shadow: 0 0 40px rgba(255,215,0,0.8);}

  /* ---------- MAP ---------- */
  #map {
    height: 90vh;
    width: 90%;
    margin: 80px auto;
    border-radius: 25px;
    overflow: hidden;
    box-shadow: 0 0 60px rgba(255,215,0,0.2), 0 0 30px rgba(0,0,0,0.8);
    animation: fadeIn 2s ease;
  }

  /* ---------- BACK BUTTON ---------- */
  .back-btn {
    display: inline-block;
    margin: 30px auto;
    background: linear-gradient(135deg, #ffd700, #ffcc33);
    color: #0b1e45;
    padding: 14px 30px;
    border-radius: 40px;
    text-decoration: none;
    font-weight: 700;
    font-size: 1rem;
    box-shadow: 0 0 20px rgba(255,215,0,0.5);
    transition: 0.4s;
  }
  .back-btn:hover {
    background: #fff;
    color: #000;
    box-shadow: 0 0 40px rgba(255,215,0,1);
    transform: scale(1.08);
  }

 /* ---------- FEEDBACK SECTION ---------- */
.feedback {
  background: url("images/road.jpg") no-repeat center center/cover;
  padding: 80px 20px;
  text-align: center;
  margin: 40px auto;
}
.feedback h2, .feedback p {
  color: #ffd700;
  text-shadow: 0 0 10px rgba(0,0,0,0.7); /* text readable over image */
}
.feedback form input,
.feedback form textarea,
.feedback form select {
  background: rgba(0,0,0,0.3); /* slightly dark for readability */
  border: none;
  color: #fff;
  border-radius: 10px;
  padding: 12px;
  font-size: 1rem;
  outline: none;
}

/* ---------- CONTACT SECTION ---------- */
.contact {
  background: url("images/contatct.webp") no-repeat center center/cover;
  padding: 80px 20px;
  text-align: center;
  margin: 40px auto;
}
.contact h2, .contact .info div {
  color: #ffd700;
  text-shadow: 0 0 10px rgba(0,0,0,0.7);
}
.contact form input,
.contact form textarea {
  background: rgba(0,0,0,0.3); /* slightly dark for readability */
  border: none;
  color: #fff;
  border-radius: 10px;
  padding: 12px;
  font-size: 1rem;
  outline: none;
}

  /* ---------- FOOTER ---------- */
  footer {
    background: rgba(5,10,30,0.95);
    text-align: center;
    padding: 20px;
    color: #aaa;
    font-size: 0.9rem;
    border-top: 1px solid rgba(255,215,0,0.2);
  }

  /* ---------- ANIMATIONS ---------- */
  @keyframes fadeIn {from {opacity: 0; transform: translateY(20px);} to {opacity: 1; transform: translateY(0);}}
  @keyframes fadeInUp {from {opacity: 0; transform: translateY(40px);} to {opacity: 1; transform: translateY(0);}}

  /* ---------- FEEDBACK TOP (image only with text) ---------- */
.feedback {
  background: url("images/road2.jpg") no-repeat center center/cover;
  padding: 300px  150px;
  text-align: center;
  color: #ffd700;
  text-shadow: 0 0 10px rgba(0,0,0,0.7);
}
.feedback-top h2 {
  font-size: 3.5rem;
  margin-bottom: 10px;
}
.feedback-top p {
  font-size: 2.2rem;
  color: #fff;
}

/* ---------- FEEDBACK FORM AREA ---------- */
.feedback-form {
  background: radial-gradient(circle at top, #0b1e45 0%, #07132b 100%);
  color: #fff;
  text-align: center;
  padding: 100px 20px;
  box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.6);
}

.feedback-form h3 {
  color: #ffd700;
  margin-bottom: 25px;
  font-size: 2rem;
  letter-spacing: 1px;
  text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
  animation: fadeIn 1.5s ease;
}

.feedback-form form {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 18px;
  max-width: 500px;
  margin: 0 auto;
  animation: fadeInUp 1.5s ease;
}

.feedback-form input,
.feedback-form textarea,
.feedback-form select {
  width: 100%;
  background: rgba(10, 20, 50, 0.7);
  border: 2px solid rgba(255, 215, 0, 0.3);
  color: #fff;
  border-radius: 15px;
  padding: 14px 16px;
  font-size: 1rem;
  outline: none;
  transition: all 0.3s ease;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
}

.feedback-form input:focus,
.feedback-form textarea:focus,
.feedback-form select:focus {
  border-color: #ffd700;
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
  transform: scale(1.02);
}

.feedback-form button {
  background: linear-gradient(135deg, #ffd700, #ffcc33);
  color: #0b1e45;
  padding: 14px 35px;
  border: none;
  border-radius: 40px;
  font-weight: bold;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.4s ease;
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
}

.feedback-form button:hover {
  background: #fff;
  color: #000;
  box-shadow: 0 0 40px rgba(255, 215, 0, 0.9);
  transform: scale(1.07);
}


/* ---------- CONTACT TOP (image + details only) ---------- */

.contact {
  position: relative;
  background: url("images/contact.webp") no-repeat center center/cover;
  padding: 150px 15px;
  text-align: center;
  color: #ffd700;
  text-shadow: 0 0 10px rgba(0,0,0,0.7);
  overflow: hidden;
}

/* This adds a soft dark transparent layer above the image */
.contact::before {
  content: "";
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0, 0, 0, 0.6); /* controls transparency ‚Äî 0.45 = medium dark */
  z-index: 0;
}

/* make sure text stays visible above overlay */
.contact * {
  position: relative;
  z-index: 1;
}

.contact h2 {
  font-size: 2.5rem;
  margin-bottom: 10px;
}
.contact .info div {
  margin-bottom: 10px;
  color: #fff;
  font-size: 1.8rem;
}

/* ---------- CONTACT FORM AREA ---------- */
.contact-form {
  background: radial-gradient(circle at top, #0b1e45 0%, #061028 100%);
  color: #fff;
  text-align: center;
  padding: 100px 20px;
  box-shadow: inset 0 0 40px rgba(0, 0, 0, 0.6);
}

.contact-form h3 {
  color: #ffd700;
  margin-bottom: 25px;
  font-size: 2rem;
  letter-spacing: 1px;
  text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
  animation: fadeIn 1.5s ease;
}

.contact-form form {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 18px;
  max-width: 500px;
  margin: 0 auto;
  animation: fadeInUp 1.5s ease;
}

.contact-form input,
.contact-form textarea {
  width: 100%;
  background: rgba(10, 20, 50, 0.7);
  border: 2px solid rgba(255, 215, 0, 0.3);
  color: #fff;
  border-radius: 15px;
  padding: 14px 16px;
  font-size: 1rem;
  outline: none;
  transition: all 0.3s ease;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.4);
}

.contact-form input:focus,
.contact-form textarea:focus {
  border-color: #ffd700;
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
  transform: scale(1.02);
}

.contact-form button {
  background: linear-gradient(135deg, #ffd700, #ffcc33);
  color: #0b1e45;
  padding: 14px 35px;
  border: none;
  border-radius: 40px;
  font-weight: bold;
  font-size: 1rem;
  cursor: pointer;
  transition: all 0.4s ease;
  box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
}

.contact-form button:hover {
  background: #fff;
  color: #000;
  box-shadow: 0 0 40px rgba(255, 215, 0, 0.9);
  transform: scale(1.07);
}
/* ---------- CONTACT & FEEDBACK FORM STYLING ---------- */
.contact-section, .feedback-section {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  align-items: stretch;
  padding: 100px 10%;
  background: #0b1e45;
  color: #fff;
  gap: 40px;
}

.contact-info, .feedback-info {
  flex: 1 1 40%;
}

.contact-info h2, .feedback-info h2 {
  font-size: 2rem;
  color: #ffd700;
  margin-bottom: 20px;
}

.contact-info ul, .feedback-info ul {
  list-style: none;
  padding: 0;
}

.contact-info li, .feedback-info li {
  margin: 10px 0;
  font-size: 1rem;
  color: #f0f0f0;
}

.contact-form, .feedback-form {
  flex: 1 1 55%;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 20px;
  padding: 40px;
  box-shadow: 0 0 25px rgba(255, 215, 0, 0.2);
}

.contact-form form input,
.feedback-form form input,
.contact-form form textarea,
.feedback-form form textarea {
  width: 100%;
  margin-bottom: 20px;
  padding: 14px;
  border: none;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.1);
  color: #fff;
  font-size: 1rem;
  outline: none;
  transition: 0.3s;
}

.contact-form form input:focus,
.feedback-form form input:focus,
.contact-form form textarea:focus,
.feedback-form form textarea:focus {
  background: rgba(255, 255, 255, 0.2);
  box-shadow: 0 0 10px #ffd700;
}

.contact-form form button,
.feedback-form form button {
  width: 100%;
  padding: 14px;
  background: linear-gradient(135deg, #ffd700, #ffcc33);
  color: #0b1e45;
  font-weight: 700;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  transition: 0.3s;
}

.contact-form form button:hover,
.feedback-form form button:hover {
  background: #fff;
  color: #000;
  transform: scale(1.05);
}




</style>
</head>
<body>

<!-- ---------- NAVBAR ---------- -->
<nav>
  <div class="logo-container">
    <img src="images/pic1 .jpeg" alt="BusTrack Logo">
    <h1>BusTrack</h1>
  </div>
  <ul>
    <li onclick="goHome()">Home</li>
    <li><a href="#feedback" style="text-decoration:none;color:inherit;">Feedback</a></li>
    <li><a href="#contact" style="text-decoration:none;color:inherit;">Contact</a></li>
  </ul>
</nav>

<!-- ---------- HEADER ---------- -->
<section class="header">
  <h2>Live Bus Tracking üõ∞Ô∏è</h2>
  <p>Track your ride in real-time ‚Äî powered by BusTrack for smarter, faster, and safer travel.</p>
</section>

<!-- ---------- BUS SELECTOR ---------- -->
<div class="bus-selector">
  <label for="busSelect"><b>Select Your Bus:</b></label>
  <select id="busSelect" onchange="changeBus()">
   
  </select>
</div>

<!-- ---------- MAP ---------- -->
<div id="map"></div>

<div style="text-align:center;">
  <a href="dashboard.html" class="back-btn">‚¨Ö Back to Dashboard</a>
</div>

<!-- ---------- FEEDBACK SECTION ---------- -->
<section class="feedback" id="feedback">
  <div class="feedback-top">
    <h2>We Value Your Feedback üí¨</h2>
    <p>Tell us how BusTrack is helping you or what we can improve!</p>
  </div>
</section>

<!-- ================= FEEDBACK form ================= -->
<section class="feedback-section">
  <div class="feedback-info">
    <h2>Share Your Feedback</h2>
    <p>We value your opinion! Tell us what you liked and what we can improve. Your feedback helps us grow.</p>
    <ul>
      <li><i class="fa fa-star"></i> Honest reviews make our service better</li>
      <li><i class="fa fa-comments"></i> Every comment is read carefully</li>
    </ul>
  </div>
<div class="feedback-form">
  <div class="feedback-box">
    <h2>Send Feedback</h2>
    <input type="text" id="fbName" placeholder="Your Name" required>
<input type="text" id="fbEmail" placeholder="Your Email" required>
<textarea id="fbMessage" placeholder="Write message..." required></textarea>
<button id="sendFeedbackBtn" type="button">Send</button>

  </div>
</div>

</section>

<!-- ---------- CONTACT SECTION ---------- -->
<section class="contact" id="contact">
  <div class="contact-top">
    <h2>Contact Us üìû</h2>
    <div class="info">
      <div><h4>Email</h4><p>bustrack@gmail.com</p></div>
      <div><h4>Phone</h4><p>+92 300 1234567</p></div>
      <div><h4>Office</h4><p>Karachi, Pakistan</p></div>
    </div>
  </div>
</section>

<!-- ================= CONTACT form ================= -->
<section class="contact-section">
  <div class="contact-info">
    <h2>Have a Question? Contact Us Now</h2>
    <p>Your trips just got easier ‚Äì sit back and enjoy the ride. Travel on modern transport with the best drivers!</p>
    <ul>
      <li><i class="fa fa-phone"></i> +9-500-025-200</li>
      <li><i class="fa fa-envelope"></i>bustrack@gmail.com</li>
    </ul>
  </div>

<div class="contact-form">
  <div class="contact-box">
    <h2>Send a Message</h2>
    <input type="text" id="ctName" placeholder="Your Name" required>
    <input type="text" id="ctPhone" placeholder="Phone Number">
    <input type="email" id="ctEmail" placeholder="Your Email" required>
    <input type="text" id="ctSubject" placeholder="Subject" required>
    <textarea id="ctMessage" placeholder="Your Message" required></textarea>
   <button id="sendContactBtn" type="button">Send</button>
   

  </div>
</div>

</section>



<!-- ---------- FOOTER ---------- -->
<footer>¬© 2025 BusTrack | Real-Time Smart Transit Solutions üöå</footer>

<script>
function goHome() {
  window.location.href = "dashboard.html";
}

// ---------- Initialize Map ----------
const map = L.map('map').setView([24.8607, 67.0011], 13); // Front view: Karachi
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '¬© BusTrack'
}).addTo(map);

// ---------- Load Buses Added by Admin ----------
let busList = JSON.parse(localStorage.getItem('buses')) || [];

// Convert route strings to arrays if needed
busList.forEach(bus => {
    if (typeof bus.route === 'string') {
        bus.route = JSON.parse(bus.route); // convert string to array
    }
    bus.speed = bus.speed || 0.01; // default speed if missing
});

let buses = {}; // Stores marker and route info for each bus
let selectedBusId = null;

// ---------- Update Dropdown Menu ----------
function updateBusDropdown() {
    const dropdown = document.getElementById('busSelect');
    dropdown.innerHTML = '';
    const placeholder = document.createElement('option');
    placeholder.text = 'Select a Bus';
    placeholder.value = '';
    placeholder.disabled = true;
    placeholder.selected = true;
    dropdown.appendChild(placeholder);

    busList.forEach(bus => {
        const option = document.createElement('option');
        option.value = bus.id;
        option.text = bus.name;
        dropdown.appendChild(option);
    });
}

updateBusDropdown();

// ---------- Initialize All Bus Markers ----------

busList.forEach(busData => {
    const route = busData.route || [[24.8607, 67.0011]]; // default route
    const status = Math.random() < 0.5 ? 'On Time ‚úÖ' : 'Delayed ‚è∞'; // random status

    buses[busData.id] = {
        marker: L.marker(route[0], {title: busData.name})
            .addTo(map)
            .bindPopup(`<b>${busData.name}</b> - ${status}`)
            .openPopup(),
        route: route,
        index: 0,
        speed: busData.speed || 0.01,
        status: status
    };
});

// ---------- Start Tracking Selected Bus ----------
function startBusTracking(busId) {
    selectedBusId = busId;

    const bus = buses[busId];
    if (!bus) return;

    // Reset bus to start position
    bus.index = 0;
    bus.marker.setLatLng(bus.route[0]);
    bus.marker.bindPopup(`<b>${busList.find(b => b.id==busId).name}</b>`).openPopup();

    // Fit map to the bus route
    map.fitBounds(L.polyline(bus.route).getBounds());
}

// ---------- Dropdown Change Event ----------
document.getElementById('busSelect').addEventListener('change', function() {
    startBusTracking(this.value);
});

// ---------- Move Buses Along Their Routes ----------
function moveBuses() {
    Object.keys(buses).forEach(busId => {
        const bus = buses[busId];
        if (bus.index >= bus.route.length - 1) return;

        const [lat1, lng1] = bus.route[bus.index];
        const [lat2, lng2] = bus.route[bus.index + 1];
        const step = bus.speed;

        const nextLat = lat1 + (lat2 - lat1) * step;
        const nextLng = lng1 + (lng2 - lng1) * step;

        bus.marker.setLatLng([nextLat, nextLng]);
bus.marker.bindPopup(`<b>${busList.find(b => b.id==busId).name}</b> - ${bus.status}`);


        // Snap to the next point
        if (Math.abs(nextLat - lat2) < 0.0001 && Math.abs(nextLng - lng2) < 0.0001) {
            bus.index++;
            bus.route[bus.index] = [lat2, lng2];
        }

        // Center map on selected bus only
        if (busId == selectedBusId) {
            map.setView([nextLat, nextLng], 14);
        }
    });
}

// ---------- Start Simulation Loop ----------
setInterval(moveBuses, 1000);



// ================= FORMS save  =================


// Feedback form submission
window.addEventListener('DOMContentLoaded', function() {
document.getElementById('sendFeedbackBtn').addEventListener('click', function() {
  const name = document.getElementById('fbName').value.trim();
  const email = document.getElementById('fbEmail').value.trim();
  const message = document.getElementById('fbMessage').value.trim();
 

  // Validation
  const nameRegex = /^[A-Za-z\s]+$/;
  const emailRegex = /^[a-zA-Z0-9._%+-]+@gmail\.com$/;


  if (!nameRegex.test(name)) {
    alert("‚ùå Enter a valid name (letters only).");
    return;
  }

  if (!emailRegex.test(email)) {
    alert("‚ùå Enter a valid Gmail address (example@gmail.com).");
    return;
  }

  if (!message) {
    alert("‚ùå Please enter your feedback message.");
    return;
  }



 const feedback = { 
  id: Date.now().toString(),  // <- unique ID
  name, 
  email, 
  message, 
  date: new Date().toLocaleString() 
};
let messages = JSON.parse(localStorage.getItem('feedback')) || [];
messages.push(feedback);
localStorage.setItem('feedback', JSON.stringify(messages));

  alert("‚úÖ Thank you for your feedback!");
  
  // Clear fields
  document.getElementById('fbName').value = '';
  document.getElementById('fbEmail').value = '';
  document.getElementById('fbMessage').value = '';

});
});



// Contact form submission
window.addEventListener('DOMContentLoaded', function() {
  document.getElementById('sendContactBtn').addEventListener('click', function() {
    const name = document.getElementById('ctName').value.trim();
    const phone = document.getElementById('ctPhone').value.trim();
    const email = document.getElementById('ctEmail').value.trim();
    const subject = document.getElementById('ctSubject').value.trim();
    const message = document.getElementById('ctMessage').value.trim();

    const nameRegex = /^[A-Za-z\s]+$/;
    const emailRegex = /^[a-zA-Z0-9._%+-]+@gmail\.com$/;
    const phoneRegex = /^[0-9]+$/;


    if (!nameRegex.test(name)) { alert("‚ùå user name only contains alphabets."); return; }
    if (!emailRegex.test(email)) { alert("‚ùå Enter a valid Gmail."); return; }
    if (!phoneRegex.test(phone)) { alert("‚ùå phone number only contains digits."); return; }
    if (!subject || !message) { alert("‚ùå Subject/Message cannot be empty."); return; }

    let messages = JSON.parse(localStorage.getItem('contactMessages')) || [];
   messages.push({ 
  id: Date.now().toString(),  // <- automatically generated unique ID
  name, 
  phone, 
  email, 
  subject, 
  message, 
  date: new Date().toLocaleString() 
});

    localStorage.setItem('contactMessages', JSON.stringify(messages));

    alert("‚úÖ Your message has been sent !");

    document.getElementById('ctName').value = '';
    document.getElementById('ctPhone').value = '';
    document.getElementById('ctEmail').value = '';
    document.getElementById('ctSubject').value = '';
    document.getElementById('ctMessage').value = '';
  });
});

 window.addEventListener('DOMContentLoaded', function() {
      updateTrackingDropdown();
  });
</script>

</body>
</html>
